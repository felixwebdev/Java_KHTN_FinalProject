<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="Untree.co">
	<link rel="shortcut icon" href="favicon.png">

	<meta name="description" content="" />
	<meta name="keywords" content="bootstrap, bootstrap5" />

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;600;700&display=swap" rel="stylesheet">


	<link rel="stylesheet" href="fonts/icomoon/style.css">
	<link rel="stylesheet" href="fonts/flaticon/font/flaticon.css">

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

	<link rel="stylesheet" href="css/tiny-slider.css">
	<link rel="stylesheet" href="css/aos.css">
	<link rel="stylesheet" href="css/glightbox.min.css">
	<link rel="stylesheet" href="css/style.css">

	<link rel="stylesheet" href="css/flatpickr.min.css">
	
	<link rel="stylesheet" href="css/subStyle.css">


	<title>Blogy</title>
</head>
<body>

	<div class="site-mobile-menu site-navbar-target">
		<div class="site-mobile-menu-header">
			<div class="site-mobile-menu-close">
				<span class="icofont-close js-menu-toggle"></span>
			</div>
		</div>
		<div class="site-mobile-menu-body"></div>
	</div>

	<nav class="site-nav">
		<div class="container">
			<div class="menu-bg-wrap">
				<div class="site-navigation">
					<div class="row g-0 align-items-center">
						<div class="col-2">
							<a href="index.html" class="logo m-0 float-start">Blogy<span class="text-primary">.</span></a>
						</div>
						<div class="col-8 text-center">
							<ul class="js-clone-nav d-none d-lg-inline-block text-start site-menu mx-auto">
								<li><a href="index.html">Home</a></li>
								<li><a href="blog.html">Blogs</a></li>
								<li><a href="contact.html">Contact Us</a></li>
								<li class="active"><a href="share.html">Share</a></li>
							</ul>
						</div>
						<div class="col-2 text-end nav-account">
							<div class="account-not-signedin">
								<div class="account-icon" id="openAuthModal">
									<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-person-add" viewBox="0 0 16 16">
									<path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0m-2-6a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"/>
									<path d="M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"/>
									</svg>
								</div>
							</div>

							<div class="account-signedin">
								<div class="account-icon">
									<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
									<path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
									</svg>
								</div>
								<ul class="account-dropdown">
									<li><a href="#">Profile</a></li>
									<li><a href="myBlogs.html">My Blogs</a></li>
									<li id="btn-signOut"><a href="#">Sign out</a></li>
								</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</nav>

	<!-- Modal đăng nhập/đăng ký -->
	<div id="authModal" class="auth-modal">
		<div class="auth-modal-content">

			<span class="auth-close" id="closeAuthModal">&times;</span>

			<h2 class="auth-title" id="authTitle">Sign In</h2>

			<!-- Form đăng nhập -->
			<form id="signinForm" class="auth-form active">
				<input type="email" placeholder="Email" required />
				<input type="password" placeholder="Password" required />
				<button type="submit" class="auth-btn">Sign In</button>

				<p class="switch-text">
					Don't have an account?
					<a href="#" id="toSignup">Sign Up</a>
				</p>
			</form>

			<!-- Form đăng ký -->
			<form id="signupForm" class="auth-form">
				<input type="email" placeholder="Email" required />
				<input type="password" placeholder="Password" required />
				<input type="text" placeholder="Full Name" required />
				<input type="date" name="" id="" required/>
				<button type="submit" class="auth-btn">Sign Up</button>

				<p class="switch-text">
					Already have an account?
					<a href="#" id="toSignin">Sign In</a>
				</p>
			</form>

		</div>
	</div>

	<!-- Form tạo bài đăng -->
    <section class="site-section" id="createPost" style="padding: 40px 0;">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card shadow-sm p-4">
                        <h2 class="mb-3">Share a Post</h2>
                        <form id="shareForm" class="share-form" enctype="multipart/form-data" autocomplete="off">
                            <div class="mb-3">
                                <label for="postTitle" class="form-label">Tiêu đề</label>
                                <input type="text" id="postTitle" name="title" class="form-control" placeholder="Nhập tiêu đề" required />
                            </div>

                            <div class="mb-3">
                                <label for="postDescription" class="form-label">Mô tả ngắn</label>
                                <textarea id="postDescription" name="shortDes" class="form-control" rows="2" placeholder="Mô tả ngắn" required></textarea>
                            </div>

                            <div class="mb-3">
                                <label for="postContent" class="form-label">Nội dung</label>
                                <textarea id="postContent" name="content" class="form-control" rows="8" placeholder="Viết nội dung bài viết..." required></textarea>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Hình ảnh</label>
                                <input type="file" id="postImage" name="file" accept="image/*" class="form-control" />
                                <div class="mt-2">
                                    <img id="imagePreview" src="" alt="Image preview" style="display: none; max-height: 220px;" class="img-fluid rounded"/>
                                    <button id="clearImage" type="button" class="btn btn-link p-0 ms-2" style="display:none">Xóa</button>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="postLocation" class="form-label">Địa điểm</label>
                                <input type="text" id="postLocation" name="location" class="form-control" placeholder="Nhập địa điểm (ví dụ: Hà Nội, Đà Nẵng,...)" />
                            </div>

                            <div class="d-flex gap-2">
                                <button type="submit" class="btn btn-primary">Đăng bài</button>
                                <button type="button" id="saveDraft" class="btn btn-outline-secondary">Lưu nháp</button>
                            </div>

                            <div id="shareMessage" class="mt-3" style="display:none"></div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <style>
        /* Giao diện nhỏ bổ sung cho form tạo bài */
        .card .form-label { font-weight: 600; }
        #shareMessage { padding: 12px; border-radius: 6px; }
        #shareMessage.success { background: #E6F4EA; color: #0F5132; }
        #shareMessage.error { background: #F8D7DA; color: #842029; }
    </style>

    <script>
        // Handle image preview
        (function () {
            const input = document.getElementById('postImage');
            const preview = document.getElementById('imagePreview');
            const clearBtn = document.getElementById('clearImage');
            const messageEl = document.getElementById('shareMessage');

            input.addEventListener('change', (e) => {
                const file = e.target.files && e.target.files[0];
                if (!file) {
                    preview.style.display = 'none';
                    clearBtn.style.display = 'none';
                    preview.src = '';
                    return;
                }
                preview.src = URL.createObjectURL(file);
                preview.style.display = 'block';
                clearBtn.style.display = 'inline-block';
            });

            clearBtn.addEventListener('click', () => {
                input.value = '';
                preview.src = '';
                preview.style.display = 'none';
                clearBtn.style.display = 'none';
            });

            // Submit form using fetch to POST /api/posts (adjust endpoint if needed)
            const form = document.getElementById('shareForm');
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                messageEl.style.display = 'none';
                messageEl.className = '';

                const formData = new FormData(form);
                const fileInput = document.getElementById('postImage');
                const file = fileInput.files[0];
                if (file) {
                    formData.append("file", file);
                }
                try {
                    // TODO: update endpoint path to match your backend
                    const resp = await fetch('https://blogy-java-module4-blogy-java-md4.onrender.com/api/blog', {
                        method: 'POST',
                        headers: {
                            'Authorization': 'Bearer ' + localStorage.getItem('token') 
                        },
                        body: formData
                    });

                    if (!resp.ok) {
                        const errorText = await resp.text();
                        throw new Error(errorText || 'Server error');
                    }

                    messageEl.textContent = 'Đăng bài thành công';
                    messageEl.classList.add('success');
                    messageEl.style.display = 'block';
                    form.reset();
                    preview.src = '';
                    preview.style.display = 'none';
                    clearBtn.style.display = 'none';
                } catch (err) {
                    messageEl.textContent = 'Lỗi: ' + (err.message || 'Không thể gửi bài');
                    messageEl.classList.add('error');
                    messageEl.style.display = 'block';
                }
            });

            document.getElementById('saveDraft').addEventListener('click', async () => {
                // Lưu nháp localStorage (tùy chỉnh backend nếu cần)
                const draft = {
                    title: document.getElementById('postTitle').value,
                    description: document.getElementById('postDescription').value,
                    content: document.getElementById('postContent').value,
                    location: document.getElementById('postLocation').value,
                    updatedAt: new Date().toISOString()
                };
                localStorage.setItem('postDraft', JSON.stringify(draft));
                messageEl.textContent = 'Đã lưu nháp cục bộ';
                messageEl.classList.add('success');
                messageEl.style.display = 'block';
            });

            // If a draft exists, restore
            window.addEventListener('load', () => {
                const draftStr = localStorage.getItem('postDraft');
                if (draftStr) {
                    try {
                        const draft = JSON.parse(draftStr);
                        document.getElementById('postTitle').value = draft.title || '';
                        document.getElementById('postDescription').value = draft.description || '';
                        document.getElementById('postContent').value = draft.content || '';
                        document.getElementById('postLocation').value = draft.location || '';
                    } catch (err) { /* ignore */ }
                }
            });
        })();
    </script>

	<footer class="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-lg-4">
					<div class="widget">
						<h3 class="mb-4">About</h3>
						<p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts.</p>
					</div> <!-- /.widget -->
					<div class="widget">
						<h3>Social</h3>
						<ul class="list-unstyled social">
							<li><a href="#"><span class="icon-instagram"></span></a></li>
							<li><a href="#"><span class="icon-twitter"></span></a></li>
							<li><a href="#"><span class="icon-facebook"></span></a></li>
							<li><a href="#"><span class="icon-linkedin"></span></a></li>
							<li><a href="#"><span class="icon-pinterest"></span></a></li>
							<li><a href="#"><span class="icon-dribbble"></span></a></li>
						</ul>
					</div> <!-- /.widget -->
				</div> <!-- /.col-lg-4 -->
				<div class="col-lg-4 ps-lg-5">
					<div class="widget">
						<h3 class="mb-4">Company</h3>
						<ul class="list-unstyled float-start links">
							<li><a href="#">About us</a></li>
							<li><a href="#">Services</a></li>
							<li><a href="#">Vision</a></li>
							<li><a href="#">Mission</a></li>
							<li><a href="#">Terms</a></li>
							<li><a href="#">Privacy</a></li>
						</ul>
						<ul class="list-unstyled float-start links">
							<li><a href="#">Partners</a></li>
							<li><a href="#">Business</a></li>
							<li><a href="#">Careers</a></li>
							<li><a href="#">Blog</a></li>
							<li><a href="#">FAQ</a></li>
							<li><a href="#">Creative</a></li>
						</ul>
					</div> <!-- /.widget -->
				</div> <!-- /.col-lg-4 -->
				<div class="col-lg-4">
					<div class="widget">
						<h3 class="mb-4">Recent Post Entry</h3>
						<div class="post-entry-footer">
							<ul>
								<li>
									<a href="">
										<img src="images/img_1_sq.jpg" alt="Image placeholder" class="me-4 rounded">
										<div class="text">
											<h4>There’s a Cool New Way for Men to Wear Socks and Sandals</h4>
											<div class="post-meta">
												<span class="mr-2">March 15, 2018 </span>
											</div>
										</div>
									</a>
								</li>
								<li>
									<a href="">
										<img src="images/img_2_sq.jpg" alt="Image placeholder" class="me-4 rounded">
										<div class="text">
											<h4>There’s a Cool New Way for Men to Wear Socks and Sandals</h4>
											<div class="post-meta">
												<span class="mr-2">March 15, 2018 </span>
											</div>
										</div>
									</a>
								</li>
								<li>
									<a href="">
										<img src="images/img_3_sq.jpg" alt="Image placeholder" class="me-4 rounded">
										<div class="text">
											<h4>There’s a Cool New Way for Men to Wear Socks and Sandals</h4>
											<div class="post-meta">
												<span class="mr-2">March 15, 2018 </span>
											</div>
										</div>
									</a>
								</li>
							</ul>
						</div>


					</div> <!-- /.widget -->
				</div> <!-- /.col-lg-4 -->
			</div> <!-- /.row -->

			<div class="row mt-5">
				<div class="col-12 text-center">
          <!-- 
              **==========
              NOTE: 
              Please don't remove this copyright link unless you buy the license here https://untree.co/license/  
              **==========
            -->

            <p>Copyright &copy;<script>document.write(new Date().getFullYear());</script>. All Rights Reserved. &mdash; Designed with love by <a href="https://untree.co">Untree.co</a>  Distributed by <a href="https://themewagon.com">ThemeWagon</a> <!-- License information: https://untree.co/license/ -->
            </p>
          </div>
        </div>
      </div> <!-- /.container -->
    </footer> <!-- /.site-footer -->

    <!-- Preloader -->
    <div id="overlayer"></div>
    <div class="loader">
    	<div class="spinner-border text-primary" role="status">
    		<span class="visually-hidden">Loading...</span>
    	</div>
    </div>


    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/tiny-slider.js"></script>

    <script src="js/flatpickr.min.js"></script>


    <script src="js/aos.js"></script>
    <script src="js/glightbox.min.js"></script>
    <script src="js/navbar.js"></script>
    <script src="js/counter.js"></script>
    <script src="js/custom.js"></script>

	<script src="js/accounts.js"></script>
  </body>
  </html>
